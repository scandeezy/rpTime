<div id="timesheets-per-worker-by-month-for-client" ng-controller="ReportTimeSheetsPerWorkerByMonthForClientCtrl" class="container">

	<div class="row" class="hidden-print">
		<h2 ng-hide="selectedClient">Time Sheets Per Worker, By Month, For Client</h2>
		<div class="col-sm-12 hidden-print">
			<form class="form-inline" role="form">
				<div class="form-group">
					<select class="form-control hidden-print" id="client" name="client" ng-model="selectedClient"
						ng-options="client.id as client.name for (clientid,client) in clientsMap" ng-change="selectClient(selectedClient);" required>
						<option value="">-- Select Client --</option>
					</select>
				</div>
				<div class="form-group pull-right" ng-show="true && report">
					<div class="btn-group btn-group-default pull-right">
						<a type="button" class="btn btn-default"
							ng-href="#/report/timesheets-per-worker-by-month-for-client?clientId={{selectedClient}}&amp;date={{report.previousMonthReportDate}}">Previous Month</a>
						<a type="button" class="btn btn-default" 
							ng-href="#/report/timesheets-per-worker-by-month-for-client?clientId={{selectedClient}}&amp;date={{report.nextMonthReportDate}}">Next Month</a>
					</div>
				</div>
			</form>
		</div>
	</div>
	
	<div ng-show="selectedClient">

		<div id="reportSummary">
			<h2>
				<a ng-href="#/client?id={{selectedClient}}">{{clientsMap[selectedClient].name}}</a> Time Sheets
			</h2>
			<h3>{{report.reportDate}}</h3>
			<div>
				<h4>Summary</h4>
				<table id="summary" class="table table-condensed table-striped table-hover">
					<thead>
						<tr>
							<th>Worker</th>
							<th>Total Days</th>
							<th>Total Hours</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="worker in report.workerList | orderBy:'fullNameNormalized' " ng-controller="ReportTimeSheetsPerWorkerByMonthForClientWorkerCtrl">
							<td><a ng-href="#/worker?id={{worker.id}}">{{worker.fullName}}</a></td>
							<td>{{totalDaysCount}} days</td>
							<td>{{totalHoursSum | number:2}}</td>
						</tr>
					</tbody>
					<tfoot>
						<tr class="text-muted">
							<td>{{report.workerList.length}} workers</td>
							<td></td>
							<td></td>
						</tr>
					</tfoot>
				</table>
			</div>
		</div>

		<hr class="hidden-print" />

		<div class="col-sm-offset-1 page-break-before" ng-repeat="worker in report.workerList | orderBy:'fullNameNormalized'" ng-controller="ReportTimeSheetsPerWorkerByMonthForClientWorkerCtrl">

			<span class="visible-print">		
			<h2>
				<a ng-href="#/client?id={{selectedClient}}">{{clientsMap[selectedClient].name}}</a> Time Sheets
			</h2>
			<h3>{{report.reportDate}}</h3>
			</span>

			<h4>
				<a ng-href="#/worker?id={{worker.id}}">{{worker.fullName}}</a>
			</h4>

			<div class="col-sm-offset-1">
				<table class="table table-condensed table-striped table-hover" ng-show="rmap">
					<thead>
						<tr>
							<th>Date</th>
							<th ng-show="debug" class="debug">Debug</th>
							<th>Hours</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="(date,hours) in report.reportMap[worker.id]" ng-show="hours > 0" ng-init="timeSheetId=getTimeSheetLinkForDate(worker.id,date);">
							<td><a ng-href="#/timesheet?id={{timeSheetId}}">{{date}}</a></td>
							<td ng-show="debug" class="debug">
								<small>
								timeSheetId={{timeSheetId}}<br/>
								</small>
							</td>
							<td>{{hours | number:2}}
								<div class="btn-group btn-group-xs hidden-print pull-right">
									<button class="btn btn-default"
										ng-class="{'btn-danger':(report.timeSheetMap[timeSheetId].flagged), 'btn-default':!(report.timeSheetMap[timeSheetId].flagged)}"
										ng-click="report.timeSheetMap[timeSheetId].flagged=!(report.timeSheetMap[timeSheetId].flagged);flag(timeSheetId,(report.timeSheetMap[timeSheetId].flagged));">
										<span ng-class="{'text-muted':!(report.timeSheetMap[timeSheetId].flagged)}"> <span class="glyphicon glyphicon-flag"></span>&nbsp;
										</span>
									</button>
								</div>
							</td>
						</tr>
					</tbody>
					<tfoot>
						<tr class="text-muted">
							<td>{{totalDaysCount}} days</td>
							<td ng-show="debug" class="debug">Debug</td>
							<td>{{totalHoursSum | number:2}}</td>
						</tr>
					</tfoot>
				</table>

				<p ng-hide="rmap" class="text-muted">No hours logged.</p>
			</div>
			
			<div class="visible-print">
				<p>This report is as of {{report.updateDate}}.</p>
			</div>
			
		</div>

		<hr class="hidden-print" />

		<div class="hidden-print">
			<p>This report is as of {{report.updateDate}}.</p>
		</div>
	</div>

	<pre ng-show="debug" class="debug hidden-print">
selectedClient ={{selectedClient|json}}
reportMap={{reportMap|json}}
report.reportMap={{report.reportMap|json}}
report.workerList={{report.workerList|json}}
clientsMap={{clientsMap|json}}
</pre>

</div>